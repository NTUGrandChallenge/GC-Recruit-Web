{% extends 'base.html' %}

{% block css %}
<link rel="stylesheet" href="/static/css/team_profile.css">
{% endblock %}

{% block title %} 團隊 {% endblock %}

{% block content %}
{% if team.name != 'none' %}
<div class="container-fluid" id="team_profile">
    <h2>{{ team.name }}</h2>
    <p>{{ team.content }}</p>
    <div class="row">
        <div class="col-md-3 full-height" id="sidebar">
            <div style="margin-bottom: 30px">
                <img src="/static/img/team_profile_header.png" class="full-width" />
            </div>
            <div>
                領域：{{ team.interest }}
            </div>
            <div class="functions full-width">
            	<form action="" method="post">{% csrf_token %}
                {%if team.id != me.team.id%}
                    {%if team in me.applied.all%}
                        <p>申請已經發送</p>
                        <input type="hidden"  name="cancel" value="{{team.id}}">
                        <input type="submit" class="btn btn-success" value="取消申請">
                    {%elif me.team.name == 'none'%}
                        <input type="hidden"  name="applied" value="{{team.id}}">
                        <input type="submit" class="btn btn-success" value="申請加入團隊">
                    {%else%}
                        <p>您已加入其他團隊無法申請加入此團隊</p>                        
                    {%endif%}
                {%elif team.captain_name == me.name.username %}
                    {%if team.student_set.all|length > 1 %}
                        <p>團隊人數超過一人將無法解散團隊</p>
                    {%else%}
                        <input type="hidden"  name="dismiss" value="{{team.id}}">
                        <input type="submit" class="btn btn-danger" value="解散團隊">
                    {%endif%}
                {%else%}
                    <input type="hidden" name="quit" value="{{team.id}}">
                    <input type="submit" class="btn btn-danger" value="退出團隊">
                {%endif%}
            	</form>
                {%if team.id == me.team.id%}
                <div><button class="btn btn-default"><a href="/teamroom/{{ team.id }}/">團隊聊天室</a></button></div>
                <div><button class="btn btn-default"><a href="/applied_list/{{ team.id }}/">待審核成員</a></button></div>
                {% endif %}
                {% if team.captain_name == me.name.username %}
                <div><button class="btn btn-default"><a href="/upload/">挑戰提案繳交</a></button></div>
                {% endif %}
                {%if team.id == me.team.id%}
                <a href="/get_file/">挑戰提案簡報</a>
                <a href="/get_file2/">挑戰提案書</a>
                {% endif %}
            </div>
        </div>
        <div class="col-md-9">
            {% for student in team.student_set.all %}
            <a href="/other_profile/?id={{ student.id }}">
            <div class="row one-teammate">
                {%if team.captain_name == student.name %}
                    <div class="ribbon-wrapper"><div class="ribbon">隊長</div></div>
                {%endif%}
                <div class="col-xs-3">
                    <img src='http://graph.facebook.com/{{student.name.socialaccount_set.first.uid}}/picture?type=large' class="square-img">
                </div>
                <div class="col-xs-9">
                    <h4>姓名：{{student.realname}}</h4>
                    <p>學院：{{student.department}}</p>
                    <p>一句話：{{student.motto}}</p>
                    <p>團隊角色：{{student.role}}</p>
                    <form action="" method="post">{% csrf_token %}
                        {%if team.captain_name == me.name.username %}
                            {% if student != me %}
                                <input type="hidden"  name="kick" value="{{student.id}}">
                                <input type="submit" class="btn btn-success" value="踢出">
                            {%endif%}
                        {%endif%}
                     </form>
                </div>
            </div>
            </a>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}
{% endblock %}